<!DOCTYPE html>
<html>
  <head>
    <title>Campus Map</title>
    <style>
      #map {
        height: 500px;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <h2>Campus Map with Your Location and Nearby Places</h2>
    <div id="map"></div>

    <script>
      function initMap() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function (position) {
            const userLocation = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            const map = new google.maps.Map(document.getElementById('map'), {
              zoom: 17,
              center: userLocation
            });

            const infoWindow = new google.maps.InfoWindow();

            // Your current location marker (blue icon)
            const userMarker = new google.maps.Marker({
              position: userLocation,
              map: map,
              title: "You are here",
              icon: {
                url: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"
              }
            });

            userMarker.addListener("click", () => {
              infoWindow.setContent("You are here");
              infoWindow.open(map, userMarker);
            });

            // Predefined campus places
            const places = [
              {
                name: "Mechanical Engineering Department",
                lat: 15.4122845,
                lng: 75.6371228
              },
              {
                name: "Canteen",
                lat: 15.4133599,
                lng: 75.6372156
              },
              {
                name: "Library",
                lat: 15.4131802,
                lng: 75.6381490
              }
            ];

            places.forEach(place => {
              const marker = new google.maps.Marker({
                position: { lat: place.lat, lng: place.lng },
                map: map,
                title: place.name,
                label: {
                  text: place.name,
                  className: "place-label"
                }
              });

              marker.addListener("click", () => {
                infoWindow.setContent(place.name);
                infoWindow.open(map, marker);
              });
            });

          }, function () {
            handleLocationError(true);
          });
        } else {
          handleLocationError(false);
        }
      }

      function handleLocationError(browserHasGeolocation) {
        alert(browserHasGeolocation ?
          "Error: The Geolocation service failed." :
          "Error: Your browser doesn't support geolocation.");
      }
    </script>

    <!-- Replace with your actual API key -->
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCwAIaBvSNYwe8i4szx0NDx9OBCyaRr97E&callback=initMap">
    </script>
  </body>
</html>
